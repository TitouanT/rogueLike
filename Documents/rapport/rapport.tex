\documentclass[12pt]{report}
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[francais]{babel}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{listings}

\usepackage[colorinlistoftodos]{todonotes}

\usepackage[top=2cm, bottom=2cm,left=2cm, right=2cm]{geometry}

\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

\begin{document}


%% Page de titre
\begin{titlepage}
	
	\topskip0pt
	\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}
	\center
	
	\vspace*{30pt}
	
	\textsc{\Large UFR Sciences et techniques\\ Université du Maine}\\[1.5cm]
	
	\Large RAPPORT DE PROJET\\[1.5cm]
	

	\vspace*{\fill}
	
	%% Titre du rapport de projet %%
	\HRule \\[0.4cm]
	{ \huge \bfseries RogueLike}\\
	\HRule \\[1.5cm]
	 
	 
	 \vspace{12pt}
	 
	{\large \today}\\[1cm]
	
	\vspace{12pt}
	
	\Large 
	
		Emeric \textsc{Mottier}\\
		Valentin \textsc{Pelloin}\\
		Titouan \textsc{Teyssier}\\
	
		\vspace{12pt}
		
		L2 Sciences pour l'ingénieur
		
	\vspace*{\fill}
	
\end{titlepage}

%% Partie sommaire
\tableofcontents

%% Partie introduction
\chapter{Introduction}

	Nous avons choisi le jeu \emph{Roguelike} car c'est un jeu que nous trouvons intéressant, puisqu'il est complet, et que c'est un jeu aux possibilités infinies :  il est toujours possible d'ajouter de nouvelles actions que le joueur pourra effectuer.
	
	\vspace{12pt}
	
	Notre jeu se déroule dans le bâtiment IC$^2$. Nous sommes un étudiant, nous partons du rez-de-chaussée, et nous devons aller chercher QUELQUE CHOSE tout en haut, pour le ramener. \\
	Nous devons cependant faire attention aux monstres : des L1, L2, L3, des masters, des doctorants, et certains fantômes : \textsc{Claude} et \textsc{Chappe}.\\
	Sur notre chemin, nous pouvons trouver quelques pièges : des flaques d'eau laissées par les femmes de ménages qui nous font glisser, des trous entre les étages qui nous font tomber d'un étage à un autre inférieur, ou des cartes à jouer qui nous sont jetées dessus par des L1.\\
	Durant notre parcours, nous devons aussi tenir compte de notre faim. Nous possédons une barre de vie, lorsqu'elle est à zéro, nous mourrons. Pour régénérer de la vie, il y a deux possibilités : ne plus avoir faim (en mangeant de la nourriture, attention, certaines sont empoisonnées), et des seringues de soin à s'injecter directement. Ces objets peuvent être consommés directement sur place quand le joueur le trouve, ou plus tard, en les gardant dans son inventaire.\\
	Enfin, lorsque le joueur apparait, il ne voit pas entièrement la carte, il doit la découvrir pour cela. Lorsque le joueur a trop faim, en plus de perdre de la vie, il s'évanouit : il se déplace plus difficilement, et perd connaissance de ce qu'il a découvert.
	
	\vspace{12pt}
	
	Pour le projet, nous devions au minimum effectuer un jeu qui génère des niveaux (ici, des étages dans notre bâtiment) aléatoires, avec une taille variant en fonction de l'étage où se trouve le joueur. Il était aussi demandé, en fonction de l'avancement du projet, d'ajouter des fonctionnalités supplémentaires : des armes, des monstres, des pièges, ou autres.

%% Partie organisation
\chapter{Organisation}

	\section{Répartition des tâches}
		Mettre ici notre répartition des tâches.
		\subsection{Pourquoi cette répartition}

	\section{Utilisation d'un gestionnaire de versions}
	
		Pour gérer les versions du projet nous avons utilisé Git et Github. Git pour toute la partie locale à chacune de nos machine. Quand nous codons, nous pouvons ainsi faire des versions du projet régulièrement et revenir en arrière si besoin. Github pour la mise en commun des modifications apportées, ce qui nous permet de travailler ensemble sans nécessairement coder en même temps ou au même endroit. Afin que chacun puisse librement ajouter ses modifications au projet, un seul dépôt Github a été créé et chaque membre de l'équipe a reçus le droit en écriture sur le dépot.
	
	\section{Utilisation des projets Github}

	\section{Notre boîte à outils} 

		Notre projet a été réalisé en plusieurs modules différents, et l'un d'entre eux est notre boite à outil. Dedans se trouve de nombreuses fonctions qui nous sont utiles, mais qui ne sont pas pour autant liées à notre projet en particulier : des fonctions de comparaison d'intervalles, d'aléatoires, de caractères, de log d'erreurs, de fichiers, ...\\
		Nous avons aussi les fonctions essentielles pour l'accès à des listes et des files.

	\section{Doxygen, CUnit, GDB}
	
		Durant la réalisation de notre projet, nous avons utilisé divers outils d'aide à la programmation et au débogage. 
		
		\vspace{12pt}		
		
		La première chose que nous avons mis en place est la documentation à l'aide de \emph{Doxygen}. C'est un programme qui génère une documentation automatiquement, en fonction des fichiers d'en-têtes et sources. La documentation peut être générée de plusieurs formats, nous avons choisi au format HTML car il est plus facile de s'en servir. Celle-ci est sur internet, à l'adresse suivante : \url{https://roguelike.vlntn.pw/}. Elle se met à jour automatiquement en fonction de notre code (via un webhook mis en place sur Github).
		
		\vspace{12pt}
		
		Ensuite, nous avons utilisé \emph{CUnit}, un framework de tests unitaires pour le C. Toutes nos fonctions de notre boîte à outil ont été testés, avec des assertions que nous jugeons pertinentes (sur des valeurs qui pourraient poser problème dans certaines fonctions, comme des valeurs nulles, négatives, sur des fichiers inexistants, ...).
		
		\vspace{12pt}
		
		Enfin, lorsque nous avions certains bogues que nous n'arrivions pas à résoudre, nous avons utilisé le logiciel de debogage \emph{GDB} (\emph{GNU DeBugger}). Nous n'avions pas réussi à le faire fonctionner dès le début, car nous utilisons la libraire d'affichage \emph{ncurses}, qui utilise déjà le terminal pour afficher notre jeu. En le combinant avec \emph{GDB}, le terminal n'était plus utilisable.\\
		La solution à été d'utiliser deux téléscripteurs (\textsc{TTY}) differents : un pour le jeu, et un pour le débogueur.\\
		Dans l'annexe, vous pouvez retrouver 3 exemples de cas où nous nous sommes servis du débogueur.

%% Partie analyse et conception
\chapter{Analyse et Conception}

	\section{Notre cahier des charges}

	Avant de commencer à programmer notre jeu, nous nous sommes concertés autour d'un même fichier pour mettre en commun nos idées à propos du jeu. Notre jeu étant très libre dans son fonctionnement, c'était une étape cruciale.
	
		\vspace{12pt}

	Notre \emph{rogueLike} prend place dans le bâtiment IC$^2$. Le joueur démarre le jeu au premier étage. Il doit se rendre tout en haut, aller chercher l'objet, puis revenir en bas.\\
	Chaque étage de ce bâtiment est généré aléatoirement, il doit comporter des pièces et des couloirs. Entre ceux-ci, peut se trouver des portes, ou juste un trou. Les portes sont aléatoirement ouvertes ou fermées, et le joueur peut essayer des les ouvrir manuellement (il a une probabilité de ne pas réussir). Le nombre de pièces par étage est défini en fonction de l'étage : les étages supérieurs sont plus compliqués car ils possèdent plus de pièces. Pour changer d'étages, le joueur doit emprunter des escaliers (un escalier pour monter, et un pour descendre par étage, ceux-ci ne peuvent pas se trouver dans la même pièce).\\
	Lorsque le joueur apparait, il ne voit que la pièces où il se situe. Dans les couloirs, lorsqu'il progresse, les zones s'éclairent petit à petit, en revanche, dans dès qu'il entre dans une pièce, celle-ci s'éclaire entièrement.\\
	Le joueur possède un certain nombre de point de vie (défini à 10) au maximum, lorsque celle-ci est à 0, il meurt. Au fur et à mesure de ses déplacements, il perd de la nourriture (une barre allant de 0 à 100). Lorsqu'il a trop faim (nourriture inférieure à 10), il ne se déplace plus correctement, il perd certaines zones de sa mémoire de la carte (elle ne sont plus éclairées), et il perd de la vie. Le joueur peut trouver de la nourriture aléatoirement par terre (un total de 2 objets de nourriture par pièce, par étage), tout comme il peut trouver des soins de santé pour lui faire régénérer sa vie. L'autre façon de re-gagner de la vie est de manger, ainsi certains point de nourritures seront utilisées pour la vie.\\
	Lorsque le joueur mange de la nourriture, il a une faible probabilité de chance que celle-ci était empoisonnée. Le joueur perd de la vie à chaque déplacement lorsqu'il est empoisonné. Pour ne plus l'être, il doit soit attendre quelques déplacements de ne plus l'être, soit consommer un kit de santé.\\
	Durant son chemin dans le bâtiment, le joueur peut se faire avoir par des pièges. Ceux-ci peuvent, au choix, enlever de la vie, nous faire glisser à travers la pièce, ou nous faire tomber d'un ou plusieurs étages (une chance sur 3 pour chaque).\\
	Les objets tels que la nourriture, les soins de santé, ou les pièges peuvent être récupérés par le joueur dans son inventaire, pour les déposer ou les utiliser plus tard. L'inventaire du joueur possède 5 \emph{slots}, et il ne peut y déposer qu'un seul objet par \emph{slot}.\\
	Des monstres se trouvent dans le jeu, ceux-ci nous attaquent, en se rapprochant de nous. Nous pouvons aussi les attaquer. Ils possèdent, tout comme nous, une agilité, qui est plus importante pour un monstre évolué. Cette agilité permet de faire plus de dégâts au combat, et de moins en subir. Ces monstres doivent avoir une mini-intelligence artificielle pour qu'ils puissent se déplacer de façon similaire à ce que un véritable joueur pourrait faire.
	
	\vspace{12pt}

	A tout moment, l'utilisateur peut sauvegarder sa partie sur l'un des trois emplacements de sauvegarde prévus. Il peut aussi quitter le jeu à n'importe quelle étape. Au lancement, l'utilisateur doit avoir un écran lui indiquant les sauvegardes, il peut en charger une, ou en supprimer une. Si il lance le jeu sur un emplacement vide, une nouvelle partie est alors crée.\\
	A la fin du jeu, lorsque le joueur perd, ou gagne, il se retrouve sur l'écran initial des sauvegardes.\\
	Au lancement du jeu, un texte explicatif avec l'objectif de celui-ci doit être affiché. Le jeu est décomposé en trois parties :
	\begin{itemize}
	\item la zone de jeu
	\item la zone de logs, où se trouve des informations sur ce que le joueur peut effectuer
	\item la zone de statistiques, qui indique toutes les propriétés du joueur : étage, vie, faim, nombre de déplacements, si il est empoisonné, si il a trouvé l'objet, ...
	\end{itemize}
	
	\section{Règles détaillées du jeu}
	
	\section{Comment jouer ?}
		\begin{itemize}
			\item{Lancement du jeu : \\}
				Pour commencer à jouer, vous devez télécharger le jeu à partir de l'adresse suivante : \href{https://github.com/TitouanT/rogueLike/} {rogueLike}; avec la commande suivante : \texttt{git clone git@github.com:TitouanT/rogueLike.git}
				Vous faîtes : \texttt{cd rogueLike}. \\
				Puis vous compilez grâce au makefile : <<make install>>. \\
				Le jeu commence dès que vous faîtes : <<./rogueLike>>		
			\item{Les déplacement : \\}
				Nous pouvons gérer nos déplacements sur la carte grâce aux flèches de direction. 
			\item{Interactions avec des objets : \\}	
				Les interactions avec un objet (serringues de soins, nourriture, escalier) se font avec la touche <<entrée>>.
			\item{Ouvrir et fermer une porte :\\}	
				Si vous souhaitez ouvrir une porte, déplacez-vous devant la porte, appuyer sur la touche <<o>> et marqué la direction de la porte avec les flèches de direction.
				Mais pour fermer, c'est le même principe que pour ouvrir une porte sauf que la touche est <<c>> au lieu de <<o>>.
			\item{Gestion de l'inventaire : \\}
				Pour voir votre inventaire, vous devez appuyer sur la touche <<i>>. Pour prendre un objet (serringues de soins, nourriture), vous devez appuyez sur la touche <<g>> mais pour poser votre inventaire, vous devez appuyez sur la touche <<d>> et indiquer la case se trouve l'objet.
			\item{Sauvegarder sa partie :\\}
				Vous pouvez sauvegarder la partie à tout moment avec la touche <<s>>, cette manoeuvre n'arrêtera pas votre expérience de jeu.		
		\end{itemize}
		
%% Partie codage
\chapter{Codage, méthode et outil}

	\section{Structures et énumérations}
	
	\section{Séparation du code en modules}
	
	\section{Détail des modules}
	
		\subsection{La génération des niveaux}
		
		\subsection{La sauvegarde}
		
		\subsection{Les changements d'étages}
		
		\subsection{Les interactions et déplacements}
		
		\subsection{L'affichage}
		
		\subsection{Les monstres}
		
		\subsection{La nourriture et la vie}
		
		\subsection{Les pièges}

%% Partie conclusion
\chapter{Résultat et conclusion}

	Faire une comparaison avec les objectifs.
	
	\section{Améliorations possibles}
	
	\section{Apport personnel du projet}

\chapter{Annexe}


\end{document}